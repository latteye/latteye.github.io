<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 配置 Tomcat 使用 SSL · Water is</title><meta name="description" content="配置 Tomcat 使用 SSL - latteye"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://latteye.me/atom.xml" title="Water is"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">配置 Tomcat 使用 SSL</h1><div class="post-info">2008年9月25日</div><div class="post-content"><p><strong>Use keytool to create ssl certificate – only for self-signed certificate</strong></p>
<pre><code>First, use following command to generate keystore file

keytool -genkey -alias tomcat -keyalg RSA -keystore $SavePath/KeyFile

$SavePath is the path you save the file.
</code></pre><a id="more"></a>
<pre><code>Second, uncomment the “SSL HTTP/1.1 Connector” entry in server.xml;

**Third, update server.xml to use the ssl configuration as above:**
</code></pre><blockquote>
<connector port="”443″" minsparethreads="”5″" maxsparethreads="”75″" enablelookups="”true”" disableuploadtimeout="”true”" acceptcount="”100″" maxthreads="”200″" scheme="”https”" secure="”true”" sslenabled="”true”" keystorefile="”test.keystore”" keystorepass="”123654″" clientauth="”false”" sslprotocol="”TLS”/">

</connector></blockquote>
<pre><code>The bold font is the keystore filename and password.

Here we use 443 as the ssl port.

**Use openssl to make certificate and import to tomcat**

Tomcat can use the Apache Portable Runtime to provide superior scalability, performance, and better integration with native server technologies.

Requirements:

APR 1.2+ development headers (libapr1-dev package)

OpenSSL 0.9.7+ development headers (libssl-dev package)

JNI headers from Java compatible JDK 1.4+

GNU development environment (gcc, make)

The wrapper library sources are located in the Tomcat binary bundle, in the bin/tomcat-native.tar.gz archive. Once the build environment is installed and the source archive is extracted, the wrapper library can be compiled using (from the folder containing the configure script, default is /usr/local/apr):
</code></pre><p><code>./configure &amp;&amp; make &amp;&amp; make install</code></p>
<pre><code>After that,

`export LD_LIBRARY_PATH = $ LD_LIBRARY_PATH:/usr/local/apr/lib`

and then update Catalina.sh script file, add following line:

`CATALINA_OPTS=”-Djava.library.path=/usr/local/apr/lib”`

To make sure whether tomcat enabled apr, check tomcat log, if no apr enabled, the log file contains: org.apache.coyote.http11.Http11Protocol start, if apr enabled, the log should be org.apache.coyote.http11.Http11AprProtocol start.

And last, need update server.xml, add line like following:
</code></pre><blockquote>
<connector protocol="”org.apache.coyote.http11.Http11AprProtocol”" address="”{tomcat.listen.address}”" port="”443″" enablelookups="”true”" disableuploadtimeout="”true”" acceptcount="”100″" maxthreads="”200″" scheme="”https”" secure="”true”" sslenabled="”true”" sslengine="”on”" clientauth="”false”" sslprotocol="”TLS”" +sslv3="" +tlsv1″="" sslciphersuite="”HIGH:MEDIUM:!aNULL:!ADH:+SHA1:+MD5+HIGH:MEDIUM”" sslcertificatefile="”{your" certificate="" file}”="" sslcertificatekeyfile="”{your" key="" sslpassword="”{your" password="" of="" certificate}”="">

</connector></blockquote>
<pre><code>And if we want tomcat only listen on the certen IP, then server.xml should be updated as following:
</code></pre><blockquote>
<connector port="”443″" address="”10.10.0.1″" minsparethreads="”5″" maxsparethreads="”75″" enablelookups="”true”" disableuploadtimeout="”true”" acceptcount="”100″" maxthreads="”200″" scheme="”https”" secure="”true”" sslenabled="”true”" keystorefile="”test.keystore”" keystorepass="”123654″" clientauth="”false”" sslprotocol="”TLS”/">

</connector></blockquote>
<pre><code>Add address parameter, tomcat will only listen the IP you defined.
</code></pre></div></article></div></main><footer><div class="paginator"><a href="/2008/10/configure-firefox-font-in-linux.html" class="prev">PREV</a><a href="/2008/09/qmail-toaster-idhost.html" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2017 <a href="http://latteye.me">latteye</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>